<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../life-behaviors/life-canvas-behavior.html">

</head><body><dom-module id="life-canvas">
  <template>
    <canvas id="canvas" width$="[[_canvasWidth]]" height$="[[_canvasHeight]]">Your browser doesn't support html5 canvas</canvas>
  </template>

  <script>Polymer({is:"life-canvas",behaviors:[LifeCanvasBehavior],properties:{mode:{type:String,value:"cell"},canvas:{type:Object,value:function(){return this.$.canvas}},isDrawing:{type:Boolean,value:!1},mousePos:{type:Object,value:function(){return{x:-1,y:-1}}},brush:{type:Object,value:{}},editable:{type:Boolean,value:!0}},ready:function(){this.canvas.addEventListener("click",this._plotOnClick(this),!1),this.canvas.addEventListener("mousemove",this._handlePlotSeq(this),!1),this.canvas.addEventListener("mousemove",this._updateMousePos(this),!1),this.canvas.addEventListener("mousedown",this._handlePlotStart(this),!1),this.canvas.addEventListener("mouseup",this._handlePlotEnd(this),!1),this.canvas.addEventListener("mouseenter",this._handleMouseEnter(this),!1),this.canvas.addEventListener("mouseleave",this._handleMouseLeave(this),!1)},_toCellCoordinates:function(e){var t=e.target.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;return[Math.floor(n/this.cellSize),Math.floor(o/this.cellSize)]},_plotOnClick:function(e){return function(t){e.brush&&0!==Object.keys(e.brush).length&&e.editable&&e.drawPattern(e.brush,{location:"top-left",coordinate:"cursor",x:e._toCellCoordinates(t)[0],y:e._toCellCoordinates(t)[1]})}},_handlePlotStart:function(e){return function(t){e.isDrawing=!0}},_handlePlotSeq:function(e){return function(t){e.isDrawing&&e._plotOnClick(e)(t)}},_updateMousePos:function(e){return function(t){e.mousePos.x=e._toCellCoordinates(t)[0],e.mousePos.y=e._toCellCoordinates(t)[1]}},_handlePlotEnd:function(e){return function(t){e.isDrawing=!1}},_handleMouseEnter:function(e){return function(t){e.onHover=!0}},_handleMouseLeave:function(e){return function(t){e.onHover=!1}},drawPreview:function(){if(this.brush&&0!==Object.keys(this.brush).length&&this.onHover){var e=this.mousePos.x,t=this.mousePos.y,n=this.brush;this.drawPatternAsOverlay(e,t,n)}}});</script>
</dom-module>
</body></html>