<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">

<link rel="import" href="../../bower_components/paper-styles/default-theme.html">
<link rel="import" href="../../bower_components/paper-styles/shadow.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">

<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-dropdown/iron-dropdown.html">

<link rel="import" href="../life-canvas-base/life-canvas-base.html">
<link rel="import" href="../life-preview-canvas/life-preview-canvas.html">
<link rel="import" href="dropdown-wrapper.html">

<dom-module id="life-brush-editor">
  <template>
    <paper-toolbar>
      <div class="title">Brush Editor</div>
    </paper-toolbar>

    <div class="content">
      <div class="toolbar">
        <dropdown-wrapper>
          <paper-icon-button icon="create" class="dropdown-trigger"></paper-icon-button>
          <div class="dropdown-content">
            <template is="dom-repeat" items="[[brushes]]">
              <img src="[[item.thumbnail]]" alt="[[item.name]]" on-tap="_itemChanged">
            </template>
          </div>
        </dropdown-wrapper>

        <dropdown-wrapper>
          <paper-icon-button icon="delete" class="dropdown-trigger"></paper-icon-button>
          <div class="dropdown-content">
            <template is="dom-repeat" items="[[erasers]]">
              <img src="[[item.thumbnail]]" alt="[[item.name]]" on-tap="_itemChanged">
            </template>
          </div>
        </dropdown-wrapper>

        <div class="padding"></div>

        <dropdown-wrapper>
          <paper-icon-button icon="settings" class="dropdown-trigger"></paper-icon-button>
          <div class="dropdown-content">
            <paper-checkbox checked="{{hoverToPlay}}">Hover to play</paper-checkbox>
          </div>
        </dropdown-wrapper>
      </div>
      <div class="preview">
        <div class="dummy-image" style="width: 200px; height: 200px; background: #eee"></div>
        <div class="brush-info">
          <div class="brush-title">
            [[selectedItem.name]]
          </div>
          <div class="brush-meta">
            [[selectedItem.meta.x]] x [[selectedItem.meta.y]]
          </div>
        </div>
      </div>
    </div>
  </template>

  <style>
    :host {
      display: inline-block;
      position: relative;
      box-sizing: border-box;
      -moz-box-sizing: border-box;

      /*width: 300px;*/
      @apply(--shadow-elevation-2dp)

      /*@apply(--layout-horizontal);*/
    }
    .content {
      @apply(--layout-horizontal);
    }
    .toolbar {
      width: 52px;
      padding: 12px 0;

      /*background: var(--primary-color);*/
      background: #333;
      color: var(--dark-theme-text-color);

      @apply(--layout-vertical);
      @apply(--layout-center);

      @apply(--shadow-elevation-2dp);
    }
    /*.toolbar paper-icon-button[icon="settings"] {
      @apply(--layout-self-end);
    }*/
    .toolbar .padding {
      @apply(--layout-flex);
    }

    .preview .brush-info {
      padding: 4px;
    }
    .preview .brush-info .brush-title{
      color: var(--primary-text-color);
    }
    .preview .brush-info .brush-meta{
      color: var(--secondary-text-color);
      font-size: small;
    }
  </style>

  <script>
    Polymer({
      is: 'life-brush-editor',
      properties: {
        app: {
          type: Object
        },
        // rle: {
        //   type: String,
        //   value: '15b2o3b2o15b3$6b2o21b2o6b$6b2o21b2o6b2$3b2o27b2o3b$3b2o9b2o5b2o9b2o3b$9b3ob2o7b2ob3o9b$8bobo15bobo8b$8b2o17b2o8b$8bo19bo8b2$8bo19bo8b$7b2o19b2o7b$o6bo21bo6bo$o35bo4$o35bo$o6bo21bo6bo$7b2o19b2o7b$8bo19bo8b2$8bo19bo8b$8b2o17b2o8b$8bobo15bobo8b$9b3ob2o7b2ob3o9b$3b2o9b2o5b2o9b2o3b$3b2o27b2o3b2$6b2o21b2o6b$6b2o21b2o6b3$15b2o3b2o!',
        // },
        pattern: {
          type: Object
        },

        brushes: {
          type: Object,
          value: function(){
            return [{
              name: '1 x 1 Pencil',
              thumbnail: 'dummy.png',
              payload: [
                "1"
              ],
              meta: {
                x: 1,
                y: 1
              }
            },
            {
              name: '2 x 2 Pencil',
              thumbnail: 'dummy.png',
              payload: [
                "11",
                "11"
              ],
              meta: {
                x: 2,
                y: 2
              }
            },
            {
              name: '3 x 3 Pencil',
              thumbnail: 'dummy.png',
              payload: [
                "111",
                "111",
                "111"
              ],
              meta: {
                x: 3,
                y: 3
              }
            },
            {
              name: '4 x 4 Pencil',
              thumbnail: 'dummy.png',
              payload: [
                "1111",
                "1111",
                "1111",
                "1111"
              ],
              meta: {
                x: 4,
                y: 4
              }
            }];
          }
        },

        erasers: {
          type: Object,
          value: function(){
            return [{
              name: '1 x 1 Eraser',
              thumbnail: 'dummy.png',
              payload: [
                "-1"
              ],
              meta: {
                x: 1,
                y: 1
              }
            },
            {
              name: '2 x 2 Eraser',
              thumbnail: 'dummy.png',
              payload: [
                "-1-1",
                "-1-1"
              ],
              meta: {
                x: 2,
                y: 2
              }
            },
            {
              name: '3 x 3 Eraser',
              thumbnail: 'dummy.png',
              payload: [
                "-1-1-1",
                "-1-1-1",
                "-1-1-1"
              ],
              meta: {
                x: 3,
                y: 3
              }
            },
            {
              name: '4 x 4 Eraser',
              thumbnail: 'dummy.png',
              payload: [
                "-1-1-1-1",
                "-1-1-1-1",
                "-1-1-1-1",
                "-1-1-1-1"
              ],
              meta: {
                x: 4,
                y: 4
              }
            }];
          }
        },

        selectedItem: {
          type: Object,
          value: function(){
            return {};
          }
        },

        hoverToPlay: {
          type: Boolean,
          value: false,
        }


      },

      observers: [
        '_handleColorChanged(red, green, blue)'
      ],

      _itemChanged: function(e){
        this.set('selectedItem', e.model.get('item'));
      },

      _handleColorChanged: function(red, green, blue){
        // if(this.app){
          // this.app.color = 'rgb(' + red + ', ' + green + ', ' + blue + ')';
        // }
        this.set('app.color', 'rgb(' + red + ', ' + green + ', ' + blue + ')');
      },
    });
  </script>
</dom-module>
